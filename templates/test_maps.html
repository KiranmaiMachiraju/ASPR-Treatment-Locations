
{% extends "template.html" %}

{% block content %}
<style>
  html, body, #map {
    height: 95%;
    margin: 0;
    padding: 0;
  }

  /* Force map to ignore container padding */
  #map {
    min-height: 85vh;  /* fills almost the full viewport */
    width: 100%;
  }
</style>

<div id="map"></div>

<script>
  let map;

  function initMap() {
    map = new google.maps.Map(document.getElementById("map"), {
      center: { lat: 39.8283, lng: -98.5795 }, // USA center
      zoom: 3.5,
    });

    fetch('/api/states')
      .then(response => response.json())
      .then(states => {
        states.forEach(state => {
          const marker = new google.maps.Marker({
            position: { lat: state.lat, lng: state.lng },
            map: map,
            title: state.state
          });

          marker.addListener('click', () => {
            window.location.href = `/provider?state=${state.state}`;
          });
        });
      });
  }
</script>

<script
  src="https://maps.googleapis.com/maps/api/js?key={{ google_maps_api_key }}&callback=initMap"
  async defer
></script>

{% endblock %}
