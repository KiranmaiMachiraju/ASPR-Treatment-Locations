<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">
    <link rel="stylesheet" href="{{url_for('static',filename='app.css')}}">
    <title>Hello, world!</title>
  </head>
  <body>
    
    {% extends "template.html" %}

{% block content %}
<div class="container mt-5">
  <h2 class="mb-4 text-primary">Provider Directory</h2>

  <form method="get" action="{{ url_for('customer') }}" class="mb-4">
    <div class="row g-3">
      <!-- State dropdown -->
      <div class="col-md-3">
        <select name="state" class="form-control" required>
          <option value="">Select State</option>
          {% for state in states %}
            <option value="{{ state }}" {% if filters.state == state %}selected{% endif %}>{{ state }}</option>
          {% endfor %}
        </select>
      </div>

      <!-- City dropdown -->
      <div class="col-md-3">
        <select name="city" class="form-control">
          <option value="">Select City</option>
          {% for city in cities %}
            <option value="{{ city }}" {% if filters.city == city %}selected{% endif %}>{{ city }}</option>
          {% endfor %}
        </select>
      </div>

      <!-- ZIP input -->
      <div class="col-md-3">
        <input type="text" name="zip" placeholder="ZIP Code" class="form-control" value="{{ filters.zip or '' }}">
      </div>

      <!-- Filter button -->
      <div class="col-md-3">
        <button type="submit" class="btn btn-primary w-100">Filter</button>
      </div>
    </div>
  </form>

  <h4 class="mt-4">Providers:</h4>
  <table class="table table-bordered table-striped mt-3">
    <thead>
      <tr>
        <th>Provider Name</th>
        <th>Address</th>
        <th>City</th>
        <th>State</th>
        <th>ZIP</th>
        <th>Phone</th>
      </tr>
    </thead>
    <tbody>
      {% for provider in providers %}
      <tr>
        <td>{{ provider['provider_name'] }}</td>
        <td>
          {{ provider['address_1'] }}{% if provider['address_2'] %}, {{ provider['address_2'] }}{% endif %}
        </td>
        <td>{{ provider['city'] }}</td>
        <td>{{ provider['state'] }}</td>
        <td>{{ provider['zip'] }}</td>
        <td>{{ provider['public_phone'] }}</td>
      </tr>
      {% else %}
      <tr>
        <td colspan="6" class="text-center text-muted">No providers found for the selected filters.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- Optional: Pagination (if enabled in app.py) -->
  {% if total_pages and total_pages > 1 %}
  <nav aria-label="Page navigation" class="mt-4">
    <ul class="pagination justify-content-center">
      {% if page > 1 %}
      <li class="page-item">
        <a class="page-link" href="{{ url_for('customer', state=filters.state, city=filters.city, zip=filters.zip, page=page-1) }}">Previous</a>
      </li>
      {% endif %}

      {% for p in range(1, total_pages + 1) %}
      <li class="page-item {% if p == page %}active{% endif %}">
        <a class="page-link" href="{{ url_for('customer', state=filters.state, city=filters.city, zip=filters.zip, page=p) }}">{{ p }}</a>
      </li>
      {% endfor %}

      {% if page < total_pages %}
      <li class="page-item">
        <a class="page-link" href="{{ url_for('customer', state=filters.state, city=filters.city, zip=filters.zip, page=page+1) }}">Next</a>
      </li>
      {% endif %}
    </ul>
  </nav>
  {% endif %}

  <a href="{{ url_for('home') }}" class="btn btn-outline-secondary mt-3">‚Üê Back to Home</a>
</div>
{% endblock %}

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-U1DAWAznBHeqEIlVSCgzq+c9gqGAJn5c/t99JyeKa9xxaYpSvHU5awsuZVVFIhvj" crossorigin="anonymous"></script>
  </body>
</html>